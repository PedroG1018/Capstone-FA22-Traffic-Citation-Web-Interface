<form [formGroup]="citationFormGroup">
    <div class="" *ngIf="citation && violations">
        <div>
            <mat-radio-group formControlName="type" [(ngModel)]="citation.type">
                <mat-radio-button value="Misdemeanor">Misdemeanor</mat-radio-button>
                <mat-radio-button value="Traffic">Traffic</mat-radio-button>
                <mat-radio-button value="Non-Traffic">Non-Traffic</mat-radio-button>
            </mat-radio-group>
            <br><br>
        </div>

        <mat-form-field appearance="fill">
            <mat-label>Date</mat-label>
            <input matInput required formControlName="date" [(ngModel)]="citation.date" type="date" />
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Time</mat-label>
            <input matInput required formControlName="time" [ngModel]="(citation.time)"
                (ngModelChange)="citation.time = $event" type="time" name="Time" />
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label for="desc">Description</mat-label>
            <input matInput required formControlName="desc" [(ngModel)]="citation.desc" type="text" name="desc"
                placeholder="Description" />

        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label for="violation_loc">Location</mat-label>
            <input matInput required formControlName="violation_loc" [(ngModel)]="citation.violation_loc" type="text"
                name="violation_loc" placeholder="Location" />
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label for="vin">Vehicle License Number or VIN</mat-label>
            <input matInput required formControlName="vin" [(ngModel)]="citation.vin" type="text" name="vin"
                placeholder="Veh. Lic. No. or VIN" />
        </mat-form-field>

        <br>

        <mat-form-field appearance="fill">
            <mat-label>State</mat-label>
            <mat-select formControlName="vin_state" [(ngModel)]="citation.vin_state" name="vin_state">
                <mat-option *ngFor="let state of states" [value]="state">{{state}}</mat-option>
            </mat-select>
        </mat-form-field>
        <br>

        <div *ngIf="editingCitation">
            <mat-accordion *ngIf="violations.length > 0">
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title>Violations</mat-panel-title>
                    <mat-panel-description>Violations Committed</mat-panel-description>
                  </mat-expansion-panel-header>
                  <p *ngFor="let violation of violations">
                    
                  </p>
                </mat-expansion-panel>
              </mat-accordion>
        </div>

        <form [formGroup]="citationFormGroup">
            <ng-container formArrayName="violations" *ngFor="let quantity of violationsArray().controls; let i=index">
                <br><span class="text-center">Violation {{ i+1 }}</span><br>
                <div class="table-container">
                    <tbody>
                        <tr [formGroupName]="i">
                            <td class="mt-1 mb-3">
                                <button (click)="removeViolation(i)" class="btn btn-danger">Remove</button>
                            </td>
                        </tr>
                        <tr [formGroupName]="i">
                            <td>
                                <mat-form-field appearance="fill">
                                    <mat-label>Group</mat-label>
                                    <input matInput required [(ngModel)]="violations[i].group" type="text"
                                        formControlName="group" placeholder="Group">
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field appearance="fill">
                                    <mat-label>Code</mat-label>
                                    <input matInput required [(ngModel)]="violations[i].code" type="text"
                                        formControlName="code" placeholder="Code">
                                </mat-form-field>
                            </td>
                        </tr>
                        <tr [formGroupName]="i">
                            <td>
                                <mat-form-field appearance="fill">
                                    <mat-label>Degree</mat-label>
                                    <input matInput required [(ngModel)]="violations[i].degree" type="text"
                                        formControlName="degree" placeholder="Degree">
                                </mat-form-field>

                            </td>
                            <td>
                                <mat-form-field appearance="fill">
                                    <mat-label>Description</mat-label>
                                    <input matInput required [(ngModel)]="violations[i].desc" type="text"
                                        formControlName="desc" placeholder="Desc">
                                </mat-form-field>
                            </td>
                        </tr>
                    </tbody>

                </div>

            </ng-container>
            <br><button mat-raised-button color="primary" (click)="addViolation()">Add
                Violation</button><br><br>
        </form>

        <div class="form-group">
            <label>Owner's Fault?</label><br>
            <mat-radio-group formControlName="owner_fault" [(ngModel)]="citation.owner_fault">
                <mat-radio-button [value]="true">Yes</mat-radio-button>
                <mat-radio-button [value]="false">No</mat-radio-button>
            </mat-radio-group>
        </div>

    </div>
</form>