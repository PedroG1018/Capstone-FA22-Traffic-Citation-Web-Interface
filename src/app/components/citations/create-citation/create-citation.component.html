<mat-stepper>
    <mat-step [stepControl]="driverFormGroup">
        <!-- <button  mat-raised-button color="primary" (click)="autoFillForm()">Dev Button - Autofill Form</button> -->
        <ng-template matStepLabel="">Fill out driver's information</ng-template>
        <div class="p-4">
            <mat-card>
                <mat-card-header>
                    <mat-card-title>
                        <h2>Driver Information</h2>
                    </mat-card-title>
                </mat-card-header>

                <mat-card-content>
                    <app-driver-form [driver]="driver" [editingForm]="false"></app-driver-form>
                </mat-card-content>

                <mat-card-actions>
                    <button mat-raised-button color="primary" matStepperPrevious>Back</button>
                    <button mat-raised-button color="primary" matStepperNext>Next</button>
                </mat-card-actions>
            </mat-card>
        </div>
    </mat-step>

    <mat-step [stepControl]="citationFormGroup">
        <form [formGroup]="citationFormGroup">
            <ng-template matStepLabel>Fill out traffic citation</ng-template>
            <div class="main-container p-4" *ngIf="citation && citationViolations && citationWithViolations">
                <mat-card tabindex="0" class="example-card">
                    <mat-card-header>
                        <mat-card-title>
                            <h2>Citation</h2>
                        </mat-card-title>
                    </mat-card-header>

                    <mat-card-content>
                        <app-citation-form [citation]="citation" [violations]="citationViolations">

                        </app-citation-form>
                        <!-- <div>
                            <mat-radio-group formControlName="type" [(ngModel)]="citation.type">
                                <mat-radio-button value="Misdemeanor">Misdemeanor</mat-radio-button>
                                <mat-radio-button value="Traffic">Traffic</mat-radio-button>
                                <mat-radio-button value="Non-Traffic">Non-Traffic</mat-radio-button>
                            </mat-radio-group>
                            <br><br>
                        </div>

                        <mat-form-field appearance="fill">
                            <mat-label>Date</mat-label>
                            <input matInput required formControlName="date" [(ngModel)]="citation.date" type="date" />
                        </mat-form-field>

                        <mat-form-field appearance="fill">
                            <mat-label>Time</mat-label>
                            <input matInput required formControlName="time" [ngModel]="(citation.time)"
                                (ngModelChange)="citation.time = $event" type="time" name="Time" />
                        </mat-form-field>

                        <mat-form-field appearance="fill">
                            <mat-label for="desc">Description</mat-label>
                            <input matInput required formControlName="desc" [(ngModel)]="citation.desc" type="text"
                                name="desc" placeholder="Description" />

                        </mat-form-field>

                        <mat-form-field appearance="fill">
                            <mat-label for="violation_loc">Location</mat-label>
                            <input matInput required formControlName="violation_loc"
                                [(ngModel)]="citation.violation_loc" type="text" name="violation_loc"
                                placeholder="Location" />
                        </mat-form-field>

                        <mat-form-field appearance="fill">
                            <mat-label for="vin">Vehicle License Number or VIN</mat-label>
                            <input matInput required formControlName="vin" [(ngModel)]="citation.vin" type="text"
                                name="vin" placeholder="Veh. Lic. No. or VIN" />
                        </mat-form-field>

                        <br>

                        <mat-form-field appearance="fill">
                            <mat-label>State</mat-label>
                            <mat-select formControlName="vin_state" [(ngModel)]="citation.vin_state" name="vin_state">
                                <mat-option *ngFor="let state of states" [value]="state">{{state}}</mat-option>
                            </mat-select>
                        </mat-form-field>

                        <form [formGroup]="citationFormGroup">
                            <ng-container formArrayName="violations"
                                *ngFor="let quantity of violations().controls; let i=index">
                                <br><span class="text-center">Violation {{ i+1 }}</span><br>
                                <div class="table-container">
                                    <tbody>
                                        <tr [formGroupName]="i">
                                            <td class="mt-1 mb-3">
                                                <button (click)="removeViolation(i)"
                                                    class="btn btn-danger">Remove</button>
                                            </td>
                                        </tr>
                                        <tr [formGroupName]="i">
                                            <td>
                                                <mat-form-field appearance="fill">
                                                    <mat-label>Group</mat-label>
                                                    <input matInput required [(ngModel)]="citationViolations[i].group"
                                                        type="text" formControlName="group" placeholder="Group">
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field appearance="fill">
                                                    <mat-label>Code</mat-label>
                                                    <input matInput required [(ngModel)]="citationViolations[i].code"
                                                        type="text" formControlName="code" placeholder="Code">
                                                </mat-form-field>
                                            </td>
                                        </tr>
                                        <tr [formGroupName]="i">
                                            <td>
                                                <mat-form-field appearance="fill">
                                                    <mat-label>Degree</mat-label>
                                                    <input matInput required [(ngModel)]="citationViolations[i].degree"
                                                        type="text" formControlName="degree" placeholder="Degree">
                                                </mat-form-field>

                                            </td>
                                            <td>
                                                <mat-form-field appearance="fill">
                                                    <mat-label>Description</mat-label>
                                                    <input matInput required [(ngModel)]="citationViolations[i].desc"
                                                        type="text" formControlName="desc" placeholder="Desc">
                                                </mat-form-field>
                                            </td>
                                        </tr>
                                    </tbody>

                                </div>

                            </ng-container>
                            <br><button mat-raised-button color="primary" (click)="addViolation()">Add
                                Violation</button><br><br>
                        </form>

                        <div class="form-group">
                            <label>Owner's Fault?</label><br>
                            <mat-radio-group formControlName="owner_fault" [(ngModel)]="citation.owner_fault">
                                <mat-radio-button [value]="true">Yes</mat-radio-button>
                                <mat-radio-button [value]="false">No</mat-radio-button>
                            </mat-radio-group>
                        </div> -->
                    </mat-card-content>

                    <mat-card-actions>
                        <button mat-raised-button color="primary" matStepperPrevious>Back</button>
                        <button mat-raised-button color="primary" matStepperNext>Next</button>
                    </mat-card-actions>
                </mat-card>
            </div>
        </form>
    </mat-step>

    <mat-step [stepControl]="officerFormGroup">
        <ng-template matStepLabel>Officer Information</ng-template>
        <form [formGroup]="officerFormGroup">
            <div class="main-container p-4" *ngIf="citation">
                <mat-card tabindex="0" class="example-card">
                    <mat-card-header>
                        <mat-card-title>
                            <h2>Officer Information</h2>
                        </mat-card-title>
                    </mat-card-header>

                    <mat-card-content>
                        <mat-form-field appearance="fill">
                            <mat-label>Arresting Officer Name</mat-label>
                            <input matInput required formControlName="officer_name" [(ngModel)]="citation.officer_name"
                                type="text" placeholder="Name" />
                        </mat-form-field>

                        <mat-form-field appearance="fill">
                            <mat-label>Badge No.</mat-label>
                            <input matInput required formControlName="officer_badge"
                                [(ngModel)]="citation.officer_badge" type="text" placeholder="Badge #" />
                        </mat-form-field>

                        <mat-form-field appearance="fill">
                            <mat-label>Signed Date</mat-label>
                            <input matInput required formControlName="sign_date" [(ngModel)]="citation.sign_date"
                                class="form-control" type="date" />
                        </mat-form-field>
                    </mat-card-content>

                    <mat-card-actions>
                        <button mat-raised-button color="primary" matStepperPrevious>Back</button>
                        <button mat-raised-button color="primary" matStepperNext>Next</button>
                    </mat-card-actions>
                </mat-card>
            </div>
        </form>
    </mat-step>

    <mat-step *ngIf="citation">
        <ng-template matStepLabel>Done</ng-template>
        <div class="main-container p-4">
            <mat-card>
                <mat-card-header>
                    <mat-card-title>
                        <h2>Summary</h2>
                    </mat-card-title>
                </mat-card-header>

                <mat-card-content>

                    <app-view-citation-summary [citation]="citation" [violations]="citationViolations"
                        [driver]="driver">
                    </app-view-citation-summary>
                </mat-card-content>

                <mat-card-actions class="mb-2 mt-3">
                    <button mat-raised-button color="primary" matStepperPrevious>Back</button>
                    <button mat-raised-button color="primary" (click)="onFormSubmit()"
                        *ngIf="!citation.citation_id && !citationCreated" type="submit">Submit</button>

                    <button *ngIf="citationCreated" routerLink="/create-citation" routerLinkActive="active"
                        mat-raised-button color="primary">Create Another</button>
                </mat-card-actions>
            </mat-card>
        </div>
    </mat-step>
</mat-stepper>